<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>集群 | druid 中文网</title>
    <meta name="description" content="Druid是一个专门针对事件数据的OLAP查询而设计的开源数据存储系统。此页面旨在为读者介绍关于Druid存储数据的高级概述，以及Druid集群的架构。">
    <link rel="icon" href="/imgs/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.4ab36692.css" as="style"><link rel="preload" href="/assets/js/app.7684bae7.js" as="script"><link rel="preload" href="/assets/js/10.c6568e35.js" as="script"><link rel="prefetch" href="/assets/js/11.8085fb6b.js"><link rel="prefetch" href="/assets/js/2.5dfb5464.js"><link rel="prefetch" href="/assets/js/3.fdd76a05.js"><link rel="prefetch" href="/assets/js/4.b92890f1.js"><link rel="prefetch" href="/assets/js/5.a9510b1b.js"><link rel="prefetch" href="/assets/js/6.84f350a0.js"><link rel="prefetch" href="/assets/js/7.bf4683c9.js"><link rel="prefetch" href="/assets/js/8.af120a1b.js"><link rel="prefetch" href="/assets/js/9.2937fc3e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4ab36692.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">druid 中文网</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="http://druid.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  官网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/apache/incubator-druid" target="_blank" rel="noopener noreferrer" class="nav-link external">
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="http://druid.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  官网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/apache/incubator-druid" target="_blank" rel="noopener noreferrer" class="nav-link external">
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#数据" class="sidebar-link">数据</a></li><li class="sidebar-sub-header"><a href="/#汇总" class="sidebar-link">汇总</a></li><li class="sidebar-sub-header"><a href="/#分片数据" class="sidebar-link">分片数据</a></li><li class="sidebar-sub-header"><a href="/#索引数据" class="sidebar-link">索引数据</a></li><li class="sidebar-sub-header"><a href="/#记载数据" class="sidebar-link">记载数据</a></li><li class="sidebar-sub-header"><a href="/#查询数据" class="sidebar-link">查询数据</a></li><li class="sidebar-sub-header"><a href="/#集群" class="sidebar-link">集群</a></li><li class="sidebar-sub-header"><a href="/#外部依赖" class="sidebar-link">外部依赖</a></li><li class="sidebar-sub-header"><a href="/#高可用性" class="sidebar-link">高可用性</a></li></ul></li><li><a href="/架构.html" class="sidebar-link">架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/架构.html#系统架构" class="sidebar-link">系统架构</a></li><li class="sidebar-sub-header"><a href="/架构.html#segments" class="sidebar-link">Segments</a></li><li class="sidebar-sub-header"><a href="/架构.html#历史节点" class="sidebar-link">历史节点</a></li><li class="sidebar-sub-header"><a href="/架构.html#索引服务" class="sidebar-link">索引服务</a></li><li class="sidebar-sub-header"><a href="/架构.html#实时节点" class="sidebar-link">实时节点</a></li></ul></li><li><a href="/快速开始.html" class="sidebar-link">快速开始</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/快速开始.html#前提条件需要：" class="sidebar-link">前提条件需要：</a></li><li class="sidebar-sub-header"><a href="/快速开始.html#入门" class="sidebar-link">入门</a></li><li class="sidebar-sub-header"><a href="/快速开始.html#启动zookeeper" class="sidebar-link">启动zookeeper</a></li><li class="sidebar-sub-header"><a href="/快速开始.html#启动druid服务" class="sidebar-link">启动Druid服务</a></li><li class="sidebar-sub-header"><a href="/快速开始.html#数据查询" class="sidebar-link">数据查询</a></li></ul></li><li><a href="/加载数据.html" class="sidebar-link">加载数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/加载数据.html#选择提取方法" class="sidebar-link">选择提取方法</a></li><li class="sidebar-sub-header"><a href="/加载数据.html#入门" class="sidebar-link">入门</a></li><li class="sidebar-sub-header"><a href="/加载数据.html#批处理、流式混合模式" class="sidebar-link">批处理、流式混合模式</a></li></ul></li><li><a href="/从文件加载数据.html" class="sidebar-link">从文件加载数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/从文件加载数据.html#入门" class="sidebar-link">入门</a></li><li class="sidebar-sub-header"><a href="/从文件加载数据.html#编写提取规范" class="sidebar-link">编写提取规范</a></li><li class="sidebar-sub-header"><a href="/从文件加载数据.html#运行任务" class="sidebar-link">运行任务</a></li><li class="sidebar-sub-header"><a href="/从文件加载数据.html#数据查询" class="sidebar-link">数据查询</a></li></ul></li><li><a href="/从流数据加载数据.html" class="sidebar-link">从流数据加载数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/从流数据加载数据.html#入门" class="sidebar-link">入门</a></li><li class="sidebar-sub-header"><a href="/从流数据加载数据.html#编写数据提取规范" class="sidebar-link">编写数据提取规范</a></li><li class="sidebar-sub-header"><a href="/从流数据加载数据.html#重启服务" class="sidebar-link">重启服务</a></li><li class="sidebar-sub-header"><a href="/从流数据加载数据.html#发送数据" class="sidebar-link">发送数据</a></li><li class="sidebar-sub-header"><a href="/从流数据加载数据.html#数据查询" class="sidebar-link">数据查询</a></li></ul></li><li><a href="/从kafka加载数据.html" class="sidebar-link">从kafka加载数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/从kafka加载数据.html#入门" class="sidebar-link">入门</a></li><li class="sidebar-sub-header"><a href="/从kafka加载数据.html#启动kafka" class="sidebar-link">启动kafka</a></li><li class="sidebar-sub-header"><a href="/从kafka加载数据.html#发送示例数据" class="sidebar-link">发送示例数据</a></li><li class="sidebar-sub-header"><a href="/从kafka加载数据.html#数据查询" class="sidebar-link">数据查询</a></li></ul></li><li><a href="/集群.html" class="active sidebar-link">集群</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/集群.html#硬件要求" class="sidebar-link">硬件要求</a></li><li class="sidebar-sub-header"><a href="/集群.html#操作系统" class="sidebar-link">操作系统</a></li><li class="sidebar-sub-header"><a href="/集群.html#下载集群" class="sidebar-link">下载集群</a></li><li class="sidebar-sub-header"><a href="/集群.html#配置deep-storage" class="sidebar-link">配置deep storage</a></li><li class="sidebar-sub-header"><a href="/集群.html#配置tranquility服务器-可选" class="sidebar-link">配置Tranquility服务器 (可选)</a></li><li class="sidebar-sub-header"><a href="/集群.html#配置tranquility-kafka-可选" class="sidebar-link">配置Tranquility Kafka (可选)</a></li><li class="sidebar-sub-header"><a href="/集群.html#配置hadoop-可选" class="sidebar-link">配置Hadoop (可选)</a></li><li class="sidebar-sub-header"><a href="/集群.html#配置druid-coordination" class="sidebar-link">配置Druid coordination</a></li><li class="sidebar-sub-header"><a href="/集群.html#调整服务查询druid进程" class="sidebar-link">调整服务查询Druid进程</a></li><li class="sidebar-sub-header"><a href="/集群.html#调整druid-brokers" class="sidebar-link">调整Druid Brokers</a></li><li class="sidebar-sub-header"><a href="/集群.html#端口开通" class="sidebar-link">端口开通</a></li><li class="sidebar-sub-header"><a href="/集群.html#启动coordinator-overlord-zookeeper-metadata-store" class="sidebar-link">启动Coordinator, Overlord, Zookeeper,  metadata store</a></li><li class="sidebar-sub-header"><a href="/集群.html#启动historicals和middlemanagers" class="sidebar-link">启动Historicals和MiddleManagers</a></li><li class="sidebar-sub-header"><a href="/集群.html#启动druid-broker" class="sidebar-link">启动Druid Broker</a></li></ul></li></ul> </div> <div class="page"> <div class="content"><h1 id="集群"><a href="#集群" aria-hidden="true" class="header-anchor">#</a> 集群</h1> <p>Druid被设计成可扩展、高容错的集群。
在本文档中，我们将搭建一个简单的集群，并讨论如何进一步配置以满足您的需求。 这个简单的集群将为Historicals和MiddleManagers提供可扩展的容错服务器，以及一个单一的coordination服务器来承载协调器和Overlord进程。在生产中，我们建议部署Coordinator和Overlord也采用多机容错配置。</p> <h2 id="硬件要求"><a href="#硬件要求" aria-hidden="true" class="header-anchor">#</a> 硬件要求</h2> <p>Coordinator和Overlord进程可以共同部署在同一台服务器上，该服务器负责处理集群的元数据和协调需求。硬件要求如下：</p> <ul><li>4核CPU</li> <li>15GB内存</li> <li>80GB SSD存储</li></ul> <p>Historicals和MiddleManagers可以共同部署在同一台服务器上，该服务器负责处理集群中的实际数据。主要需要CPU、内存和硬盘，硬件要求如下：</p> <ul><li>8核CPU</li> <li>61GB内存</li> <li>160GB SSD存储</li></ul> <p>Druid Brokers接受查询请求并将请求发送到集群的其余部分。它们还可选地保存查询的高速缓存。主要需要CPU和内存。</p> <ul><li>8核CPU</li> <li>61GB内存</li> <li>160GB SSD存储</li></ul> <p>您可以考虑在Broker服务器上运行Druid相关开源UI程序或者查询库。
更大的集群就需要更好配置的服务器。</p> <h2 id="操作系统"><a href="#操作系统" aria-hidden="true" class="header-anchor">#</a> 操作系统</h2> <p>最好Linux，java版本1.7及其以上</p> <h2 id="下载集群"><a href="#下载集群" aria-hidden="true" class="header-anchor">#</a> 下载集群</h2> <p>首先，下载和解压最新的Druid包。最好是在单个机器上操作，因为可以修改完配置文件后分发复制到所有机器。</p> <div class="language- extra-class"><pre class="language-text"><code>curl -O http://static.druid.io/artifacts/releases/druid-0.9.2-bin.tar.gz
tar -xzf druid-0.9.2-bin.tar.gz
cd druid-0.9.2
</code></pre></div><p>在druid包下，有以下内容：</p> <ul><li>LICENSE - license文件</li> <li>bin/ - 对此quickstart有用的脚本</li> <li>conf/ - 集群设置的配置模板</li> <li>conf-quickstart/ - 此quickstart的配置</li> <li>extensions/ - Druid的所有扩展</li> <li>haddop-dependencies/ - Druid haddop的依赖</li> <li>lib/ - 所有Druid核心包含的包</li> <li>quickstart/ - 对此quickstart有用的文件</li></ul> <p>需要修改conf文件夹下的配置文件</p> <h2 id="配置deep-storage"><a href="#配置deep-storage" aria-hidden="true" class="header-anchor">#</a> 配置deep storage</h2> <p>Druid用分布式文件系统或大对象（blob）存储来进行数据存储。最常用的是亚马逊S3和HDFS。</p> <h3 id="s3"><a href="#s3" aria-hidden="true" class="header-anchor">#</a> S3</h3> <p>在conf/druid/_common/common.runtime.properties配置文件中，将设置druid.extensions.loadList=[&quot;druid-s3-extensions&quot;]，然后注释掉本地存储相关配置，放开S3配置。</p> <div class="language- extra-class"><pre class="language-text"><code>druid.extensions.loadList=[&quot;druid-s3-extensions&quot;]

#druid.storage.type=local
#druid.storage.storageDirectory=var/druid/segments

druid.storage.type=s3
druid.storage.bucket=your-bucket
druid.storage.baseKey=druid/segments
druid.s3.accessKey=...
druid.s3.secretKey=...

#druid.indexer.logs.type=file
#druid.indexer.logs.directory=var/druid/indexing-logs

druid.indexer.logs.type=s3
druid.indexer.logs.s3Bucket=your-bucket
druid.indexer.logs.s3Prefix=druid/indexing-logs
</code></pre></div><h3 id="hdfs"><a href="#hdfs" aria-hidden="true" class="header-anchor">#</a> HDFS</h3> <p>在conf/druid/_common/common.runtime.properties配置文件中，将设置druid.extensions.loadList=[&quot;io.druid.extensions:druid-hdfs-storage&quot;]，然后注释掉本地存储相关配置，放开HDFS配置。</p> <div class="language- extra-class"><pre class="language-text"><code>druid.extensions.loadList=[&quot;druid-hdfs-storage&quot;]

#druid.storage.type=local
#druid.storage.storageDirectory=var/druid/segments

druid.storage.type=hdfs
druid.storage.storageDirectory=/druid/segments

#druid.indexer.logs.type=file
#druid.indexer.logs.directory=var/druid/indexing-logs

druid.indexer.logs.type=hdfs
druid.indexer.logs.directory=/druid/indexing-logs
</code></pre></div><p>将Hadoop配置XML文件（core-site.xml，hdfs-site.xml，yarn-site.xml，mapred-site.xml）放在Druid节点的classpath上。你可以通过将它们复制到conf/druid/_common/中来实现。</p> <h2 id="配置tranquility服务器-可选"><a href="#配置tranquility服务器-可选" aria-hidden="true" class="header-anchor">#</a> 配置Tranquility服务器 (可选)</h2> <p>通过Tranquility服务器的http接口能够将数据流发送到Druid。如果想使用这种方法就需要配置Tranquility服务器。</p> <h2 id="配置tranquility-kafka-可选"><a href="#配置tranquility-kafka-可选" aria-hidden="true" class="header-anchor">#</a> 配置Tranquility Kafka (可选)</h2> <p>Druid能够通过Tranquility Kafka从kafka消费获取数据流。如果想使用这种方法就需要配置Tranquility kafka。</p> <h2 id="配置hadoop-可选"><a href="#配置hadoop-可选" aria-hidden="true" class="header-anchor">#</a> 配置Hadoop (可选)</h2> <p>如果需要通过hadoop集群加载数据，在Druid集群中需要如下配置：
更新conf/middleManager/runtime.properties中的druid.indexer.task.hadoopWorkingPath参数，将索引过程中需要的临时文件指向HDFS路径。
通常会配置成druid.indexer.task.hadoopWorkingPath=/tmp/druid-indexing
将hadoop的xml(core-site.xml, hdfs-site.xml, yarn-site.xml, mapred-site.xml)配置文件放到Druid节点的classpath路径里，可以copy到conf/druid/_common/core-site.xml, conf/druid/_common/hdfs-site.xml等等。
请注意，您不需要为了从Hadoop加载数据而使用HDFS深存储。例如，如果您的集群在Amazon Web Services上运行，我们建议使用S3进行深度存储，即使您正在使用Hadoop或Elastic MapReduce加载数据。</p> <h2 id="配置druid-coordination"><a href="#配置druid-coordination" aria-hidden="true" class="header-anchor">#</a> 配置Druid coordination</h2> <p>在这个简单的集群示例中，可以在同一台服务器上，部署单个Druid Coordinator、Druid Overlord、一个ZooKeeper实例和一个嵌入式Derby元数据数据库。
修改conf/druid/_common/common.runtime.properties配置文件中druid.zk.service.host参数，指向zookeeper服务器地址。修改druid.metadata.storage.connector.connectURI和druid.metadata.storage.connector.host参数执行元数据存储地址。</p> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>生产上建议运行两个服务器，每个服务器运行一个Druid Coordinator和一个Druid Overlord。同时将ZooKeeper运行在一个独立的环境，元数据存储也用MySQL或者PostgreSQL运行在独立环境上。</p></div> <h2 id="调整服务查询druid进程"><a href="#调整服务查询druid进程" aria-hidden="true" class="header-anchor">#</a> 调整服务查询Druid进程</h2> <p>Druid Historicals和MiddleManagers节点可以通过以下参数分配调整硬件资源：</p> <div class="language- extra-class"><pre class="language-text"><code>-Xmx and -Xms
druid.server.http.numThreads
druid.processing.buffer.sizeBytes
druid.processing.numThreads
druid.query.groupBy.maxIntermediateRows
druid.query.groupBy.maxResults
druid.server.maxSize and druid.segmentCache.locations on Historical Nodes
druid.worker.capacity on MiddleManagers
</code></pre></div><p>保证 -XX:MaxDirectMemory &gt;= numThreads*sizeBytes, 否则Druid会启动失败。
有关配置选项的详细说明请参考configuration documentation 。</p> <h2 id="调整druid-brokers"><a href="#调整druid-brokers" aria-hidden="true" class="header-anchor">#</a> 调整Druid Brokers</h2> <p>Druid Brokers的主要配置如下:</p> <div class="language- extra-class"><pre class="language-text"><code>-Xmx and -Xms
druid.server.http.numThreads
druid.cache.sizeInBytes
druid.processing.buffer.sizeBytes
druid.processing.numThreads
druid.query.groupBy.maxIntermediateRows
druid.query.groupBy.maxResults
</code></pre></div><p>保证 -XX:MaxDirectMemory &gt;= numThreads*sizeBytes, 否则Druid会启动失败。
有关配置选项的详细说明请参考configuration documentation 。</p> <h2 id="端口开通"><a href="#端口开通" aria-hidden="true" class="header-anchor">#</a> 端口开通</h2> <ul><li>1527 (Derby on your Coordinator; not needed if you are using a separate metadata store like MySQL or PostgreSQL)</li> <li>2181 (ZooKeeper; not needed if you are using a separate ZooKeeper cluster)</li> <li>8081 (Coordinator)</li> <li>8082 (Broker)</li> <li>8083 (Historical)</li> <li>8084 (Standalone Realtime, if used)</li> <li>8088 (Router, if used)</li> <li>8090 (Overlord)</li> <li>8091, 8100–8199 (Druid Middle Manager; you may need higher than port 8199 if you have a very high druid.worker.capacity)</li> <li>8200 (Tranquility Server, if used)</li></ul> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>在生产上，建议将ZooKeeper和元数据存储独立部署，不要和Coordinator部署在同一个服务器上。</p></div> <h2 id="启动coordinator-overlord-zookeeper-metadata-store"><a href="#启动coordinator-overlord-zookeeper-metadata-store" aria-hidden="true" class="header-anchor">#</a> 启动Coordinator, Overlord, Zookeeper,  metadata store</h2> <p>将配置好的配置copy到协调服务器，如果本机已经配置好了也可以通过rsync来进行同步copy：</p> <div class="language- extra-class"><pre class="language-text"><code>rsync -az druid-0.9.2/ COORDINATION_SERVER:druid-0.9.2/
</code></pre></div><p>安装Zookeeper:</p> <div class="language- extra-class"><pre class="language-text"><code>curl http://www.gtlib.gatech.edu/pub/apache/zookeeper/zookeeper-3.4.6/zookeeper-3.4.6.tar.gz -o zookeeper-3.4.6.tar.gz
tar -xzf zookeeper-3.4.6.tar.gz
cd zookeeper-3.4.6
cp conf/zoo_sample.cfg conf/zoo.cfg
./bin/zkServer.sh start
</code></pre></div><p>在协调服务器上，cd进入Druid根目录，并启动协调服务（可以在不同的窗口执行或者将日志输出到文件中）。</p> <div class="language- extra-class"><pre class="language-text"><code>java `cat conf/druid/coordinator/jvm.config | xargs` -cp conf/druid/_common:conf/druid/coordinator:lib/* io.druid.cli.Main server coordinator
java `cat conf/druid/overlord/jvm.config | xargs` -cp conf/druid/_common:conf/druid/overlord:lib/* io.druid.cli.Main server overlord
</code></pre></div><p>每一个服务启动后应该都有log信息输出，在var/log/druid目录可以查看更详细的日志信息。</p> <h2 id="启动historicals和middlemanagers"><a href="#启动historicals和middlemanagers" aria-hidden="true" class="header-anchor">#</a> 启动Historicals和MiddleManagers</h2> <p>将配置好的Druid连同配置全目录拷贝到Druid Historicals和MiddleManagers服务器上。
登录服务器进入Druid根目录，执行以下指令：</p> <div class="language- extra-class"><pre class="language-text"><code>java `cat conf/druid/historical/jvm.config | xargs` -cp conf/druid/_common:conf/druid/historical:lib/* io.druid.cli.Main server historical
java `cat conf/druid/middleManager/jvm.config | xargs` -cp conf/druid/_common:conf/druid/middleManager:lib/* io.druid.cli.Main server middleManager
</code></pre></div><p>按照需要也可以添加更多的Historicals和MiddleManagers节点。</p> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>For clusters with complex resource allocation needs, you can break apart Historicals and MiddleManagers and scale the components individually. This also allows you take advantage of Druid's built-in MiddleManager autoscaling facility.</p></div> <p>如果您正在使用Kafka或通过HTTP进行基于推送的数据流加载，则还可以在MiddleManagers和Historicals的同一服务器上启动Tranquility Server。 对于大规模生产环境，MiddleManagers和Tranquility仍然可以位于同一服务器。 如果您使用流处理器运行Tranquility（而不是服务器），则可以将Tranquility与流处理器共存，而不需要单独的Tranquility服务器。</p> <div class="language- extra-class"><pre class="language-text"><code>curl -O http://static.druid.io/tranquility/releases/tranquility-distribution-0.8.0.tgz
tar -xzf tranquility-distribution-0.8.0.tgz
cd tranquility-distribution-0.8.0
bin/tranquility &lt;server or kafka&gt; -configFile &lt;path_to_druid_distro&gt;/conf/tranquility/&lt;server or kafka&gt;.json
</code></pre></div><h2 id="启动druid-broker"><a href="#启动druid-broker" aria-hidden="true" class="header-anchor">#</a> 启动Druid Broker</h2> <p>进入Druid目录，执行以下指令启动Druid Broker:</p> <div class="language- extra-class"><pre class="language-text"><code>java `cat conf/druid/broker/jvm.config | xargs` -cp conf/druid/_common:conf/druid/broker:lib/* io.druid.cli.Main server broker
</code></pre></div><p>根据查询负载也可以添加更多的Brokers。</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.7684bae7.js" defer></script><script src="/assets/js/10.c6568e35.js" defer></script>
  </body>
</html>
